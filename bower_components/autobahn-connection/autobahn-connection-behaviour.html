<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="autobahn-import.html"><script>"use strict";!function(){window.AutobahnBehaviour=window.AutobahnBehaviour||{properties:{connection:{type:Object,value:{},notify:!0},authid:{type:String,reflectToAttribute:!0,notify:!0},authMethods:{type:Array,value:function(){return["anonymous"]}},realm:{type:String,reflectToAttribute:!0,value:function(n){return"realm1"}},connection_url:{type:String,value:function(n){return"ws://localhost:8080/ws"}}},_on_close:function(n,o){console.log("disconnected",n,o.reason,o),this.dispatchEvent(new CustomEvent("autobahn-closed",{detail:{reason:n,details:o},bubbles:!0}))},_on_open:function(n,o){this.authid=o.authid,this.dispatchEvent(new CustomEvent("autobahn-opened",{detail:{session:n,details:o},bubbles:!0}))},connect:function(n,o){function t(n,t,e){if(console.log("onchallenge",t,e),console.log(e),"wampcra"==t)return console.log(o),autobahn.auth_cra.sign(o,e.challenge)}this.connection&&this.connection.isopen&&this.connection.close(),connection_config={url:this.url,realm:this.realm},this.methods.indexOf("wampcra")!=-1&&(connection_config.authmethods=this.authMethods,connection_config.authid=n,connection_config.onchallenge=t),this.connection=new autobahn.Connection(connection_config),this.connection.onclose=this._on_close.bind(this),this.connection.onopen=this._on_open.bind(this),this.connection.open()},attached:function(){this.authMethods==["anonymous"]&&this.connect(null,null)}}}();</script></head><body></body></html>