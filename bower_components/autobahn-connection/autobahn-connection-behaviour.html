<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="autobahn-import.html"><script>"use strict";!function(){window.AutobahnBehaviour=window.AutobahnBehaviour||{properties:{connection:{type:Object,value:{},notify:!0},authid:{type:String,reflectToAttribute:!0,notify:!0},authMethods:{type:Array,value:function(){return["anonymous"]}},realm:{type:String,reflectToAttribute:!0,value:function(n){return"realm1"}},connection_url:{type:String,value:function(n){return"ws://localhost:8080/ws"}}},_on_close:function(n,t){console.log("disconnected",n,t.reason,t),this.dispatchEvent(new CustomEvent("autobahn-closed",{detail:{reason:n,details:t},bubbles:!0}))},_on_open:function(n,t){this.authid=t.authid,this.dispatchEvent(new CustomEvent("autobahn-opened",{detail:{session:n,details:t},bubbles:!0}))},connect:function(n,t){function o(n,o,e){if(console.log("onchallenge",o,e),console.log(e),"wampcra"==o)return console.log(t),autobahn.auth_cra.sign(t,e.challenge)}this.connection&&this.connection.isopen&&this.connection.close();var e={url:this.connection_url,realm:this.realm};this.authMethods.indexOf("wampcra")!=-1&&(e.authmethods=this.authMethods,e.authid=n,e.onchallenge=o),this.connection=new autobahn.Connection(e),this.connection.onclose=this._on_close.bind(this),this.connection.onopen=this._on_open.bind(this),this.connection.open()},attached:function(){JSON.stringify(this.authMethods)==JSON.stringify(["anonymous"])&&this.connect(null,null)}}}();</script></head><body></body></html>